<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" charset="utf-8"></script>
    <script src="chart.js"></script>
    <script src="ebay_api.js"></script>
    <style>
        svg {
            vertical-align: middle;
            background: rgba(255, 255, 255, 0.2);
            box-shadow: inset 0 0 3px 0 #CECECE;
        }
        body {
            font: 10px sans-serif;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }
        .dot {
            stroke: #000;
        }
    </style>
</head>
<body>
<div id="canvas"></div>

<script>

    var format = d3.time.format("%Y-%m-%dT%H:%M:%S.%LZ");
    var x = {
        label: "Listing Begin",
        scale: Chart.scaleType.TIME,
        fun: function (d) {
            var dateStr = d.listingInfo[0].startTime[0];
            return format.parse(dateStr);
        }
    };
    var y = {
        label: "Current Price (USD)",
        scale: Chart.scaleType.LINEAR,
        fun: function (d) {
            return d.sellingStatus[0].currentPrice[0].__value__;
        }
    };
    var chart = new Chart(x, y);

    function populateChart(data) {
        var items = data.findItemsAdvancedResponse[0].searchResult[0].item || [];
        chart.refresh(items);
    }

    var ebay = new Ebay();
    ebay.call(populateChart);

</script>
</body>
</html>